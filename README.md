# Museum Quiz Bot

**Мультиплатформенный чат-бот для викторин по истории для Telegram и ВКонтакте.**  
Викторина использует реальные вопросы из архивов, хранит прогресс пользователя, ведёт счёт правильных ответов.  
Проект поддерживает удобное добавление новых вопросов, хранение пользовательских данных в Redis, и содержит утилиты для работы с базой вопросов.

---

## Содержание

- [Структура проекта](#структура-проекта)
- [Описание папок и файлов](#описание-папок-и-файлов)
- [Пример .env файла](#пример-env-файла)
- [Установка и подготовка](#установка-и-подготовка)
- [Запуск Telegram-бота](#запуск-telegram-бота)
- [Запуск VK-бота](#запуск-vk-бота)
- [Парсинг и подготовка вопросов](#парсинг-и-подготовка-вопросов)
- [Скрипты-утилиты](#скрипты-утилиты)
- [Особенности и советы](#особенности-и-советы)

---

## Структура проекта

```
├── bot
│   ├── quiz_bot.py
│   ├── vk_quiz_bot.py
│   └── redis_tools.py
├── data
│   └── 120br_dict.json
├── parse_questions.py
├── questions_dict.py
├── requirements.txt
├── .env.example
├── .gitignore
└── README.md
```

---

## Описание папок и файлов

- **bot/**  
  Основной код ботов (Telegram и VK), а также модуль для работы с Redis.

- **data/**  
  Обработанные JSON-файлы (используются ботами).

- **parse_questions.py**  
  CLI-скрипт для парсинга txt-файлов с вопросами, преобразует в удобную структуру.

- **questions_dict.py**  
  CLI-скрипт для генерации словаря (dict/json) вида "вопрос: ответ" для ботов.

- **requirements.txt**  
  Список зависимостей Python-пакетов.

- **.gitignore**  
  Файл с исключениями для git.

---

## Пример .env файла

```dotenv
# Telegram
TELEGRAM_TOKEN=your-telegram-bot-token

# VK
VK_GROUP_TOKEN=your-vk-group-token
VK_GROUP_ID=your_vk_group_id_as_integer

# Redis
REDIS_HOST=localhost_or_cloud_host
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# Путь до файла вопросов (опционально, если хотите переопределять путь)
QUESTIONS_PATH=data/120br_dict.json
```

---

## Установка и подготовка

1. Клонируйте репозиторий и создайте виртуальное окружение:

   ```bash
   git clone ...
   cd museum_quiz_bot
   python3 -m venv venv
   source venv/bin/activate
   ```

2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

3. Подготовьте файл `.env` на основе `.env.example`.

4. Проверьте доступность Redis-сервера (локально или облачно).

---

## Запуск Telegram-бота

```bash
python bot/quiz_bot.py
```

Бот поддерживает кнопки:

* **Новый вопрос** — выдаёт случайный вопрос из базы
* **Сдаться** — показывает ответ и сразу новый вопрос
* **Мой счёт** — показывает количество ваших правильных ответов

---

## Запуск VK-бота

```bash
python bot/vk_quiz_bot.py
```

VK-бот работает аналогично Telegram-боту.
**Важно:**

* Включите LongPoll API в настройках вашей группы VK (раздел “Работа с API”).
* Токен и id группы должны быть прописаны в `.env`.

---

## Парсинг и подготовка вопросов

**Шаг 1.**
Распакуйте архивные txt-файлы с вопросами в папку `data/`.

**Шаг 2.**
Сконвертируйте их в удобный JSON-формат:

```bash
python parse_questions.py --file data/120br.txt
python questions_dict.py --file data/120br.txt
```

В результате в `data/` появится файл `120br_dict.json`, который используют боты.

---

## Скрипты-утилиты

* **parse\_questions.py**
  Парсит текстовые архивы, выводит и проверяет структуру вопросов.

* **questions\_dict.py**
  Формирует файл-словарь для бота, может использоваться отдельно для подготовки новых паков вопросов.

> Оба скрипта поддерживают аргумент `--file` для указания пути к своему файлу.

---

## Особенности и советы

* **Расширяемость:**
  Можно добавить любые новые наборы вопросов, просто обработав их через скрипты выше.

* **Платформенность:**
  Логика Telegram-бота и VK-бота максимально унифицирована.

---

## Пример ботов

- [Telegram-бот Museum Quiz](https://t.me/QuickClockbot)
- [VK-бот Museum Quiz (чат)](https://vk.com/im?sel=-230495233)
